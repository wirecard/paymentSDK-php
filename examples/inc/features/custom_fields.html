<!DOCTYPE html><html lang="en"><head><title>examples/inc/features/custom_fields</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../"><meta name="groc-document-path" content="examples/inc/features/custom_fields"><meta name="groc-project-path" content="examples/inc/features/custom_fields.php"><link rel="stylesheet" type="text/css" media="all" href="../../../assets/style.css"><script type="text/javascript" src="../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">examples/inc/features/custom_fields.php</div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-comment">/**
 * Shop System SDK:
 * - Terms of Use can be found under:
 * https://github.com/wirecard/paymentSDK-php/blob/master/_TERMS_OF_USE
 * - License can be found under:
 * https://github.com/wirecard/paymentSDK-php/blob/master/LICENSE
 */</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h1 id="custom-fields">Custom fields</h1></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>It is possible to send data to Wirecard which will also be in the response.</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="required-objects">Required objects</h2></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>To include the necessary files, we use the composer for PSR-4 autoloading.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/../../../vendor/autoload.php'</span>;
<span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/../common.php'</span>;
<span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/../../configuration/config.php'</span>;
<span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/../header.php'</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">Amount</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">CustomField</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">CustomFieldCollection</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">Redirect</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">Response</span>\<span class="hljs-title">InteractionResponse</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">Transaction</span>\<span class="hljs-title">PayPalTransaction</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Wirecard</span>\<span class="hljs-title">PaymentSdk</span>\<span class="hljs-title">TransactionService</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="transaction-related-objects">Transaction related objects</h3></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Define the objects which are required for the transaction.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$amount</span> = <span class="hljs-keyword">new</span> Amount(<span class="hljs-number">12.59</span>, <span class="hljs-string">'EUR'</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Set redirect URLs for success, cancel and failure.
From payment page you will be redirected to:
Success URL when the payment is approved.
Cancel URL when the user cancels the transaction on payment page.
Failure URL when payment is not approved or the data are missing or incorrect</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$redirectUrls</span> = <span class="hljs-keyword">new</span> Redirect(
    getUrl(<span class="hljs-string">'../PayPal/return.php?status=success'</span>),
    getUrl(<span class="hljs-string">'../PayPal/return.php?status=cancel'</span>),
    getUrl(<span class="hljs-string">'../PayPal/return.php?status=failure'</span>)
);
<span class="hljs-variable">$notificationUrl</span> = getUrl(<span class="hljs-string">'notify.php'</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="custom-fields">Custom fields</h3></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>The custom fields are set as an special object. The data are sent with the request and
then returned with the response. Each custom field is prefixed with &#39;paysdk_&#39;,
i.e. the custom field &#39;special1&#39; will be sent and returned as &#39;paysdk_special1&#39;.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$special1</span> = <span class="hljs-keyword">new</span> CustomField(<span class="hljs-string">'special1'</span>, <span class="hljs-string">'abc123'</span>);
<span class="hljs-variable">$customFields</span> = <span class="hljs-keyword">new</span> CustomFieldCollection();
<span class="hljs-variable">$customFields</span>-&gt;add(<span class="hljs-variable">$special1</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="transaction">Transaction</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-variable">$transaction</span> = <span class="hljs-keyword">new</span> PayPalTransaction();
<span class="hljs-variable">$transaction</span>-&gt;setNotificationUrl(<span class="hljs-variable">$notificationUrl</span>);
<span class="hljs-variable">$transaction</span>-&gt;setRedirect(<span class="hljs-variable">$redirectUrls</span>);
<span class="hljs-variable">$transaction</span>-&gt;setAmount(<span class="hljs-variable">$amount</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>The custom fields need to be set for each transaction.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$transaction</span>-&gt;setCustomFields(<span class="hljs-variable">$customFields</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="transaction-service">Transaction Service</h3></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>The service is used to execute the payment operation itself. A response object is returned.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-variable">$transactionService</span> = <span class="hljs-keyword">new</span> TransactionService(<span class="hljs-variable">$config</span>);
<span class="hljs-variable">$response</span> = <span class="hljs-variable">$transactionService</span>-&gt;pay(<span class="hljs-variable">$transaction</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="response-handling">Response handling</h3></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>In this example we output our custom parameter we sent in request from our response.
Parameter with name <em>special1</em> with an expected value of <em>abc123</em></p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">if</span> (<span class="hljs-variable">$response</span> <span class="hljs-keyword">instanceof</span> InteractionResponse) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Custom field "special1" was set to: '</span> . <span class="hljs-variable">$response</span>-&gt;getCustomFields()-&gt;get(<span class="hljs-string">'special1'</span>);
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Transaction was not successful."</span>;
}

<span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/../footer.php'</span>;</div></div></div></div></body></html>